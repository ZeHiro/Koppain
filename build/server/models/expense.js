// Generated by CoffeeScript 1.6.3
var Expense, americano, async;

americano = require('americano');

async = require('async');

module.exports = Expense = americano.getModel('Expense', {
  name: String,
  value: Number,
  balanceId: String,
  payerId: String,
  payees: [
    {
      payeeId: String,
      percentage: Number
    }
  ]
});

Expense.allByBalanceID = function(balanceId, callback) {
  var params;
  params = {
    key: balanceId
  };
  return Expense.request("allByBalanceID", params, callback);
};

Expense.destroyByBalanceID = function(balanceId, callback) {
  return Expense.allByBalanceID(balanceId, function(err, expenses) {
    if (err != null) {
      callback(err);
    } else {
      return async.each(expenses, Expense["delete"], callback);
    }
  });
};

Expense["delete"] = function(expense, callback) {
  return Expense.destroy(expense.id, callback);
};
